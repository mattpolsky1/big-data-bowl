Theme
```{r}
# THEME
library(ggplot2)
library(grid)

nfl_analytics_theme <- function(base_size = 13, base_family = "sans") {
  
  theme_minimal(base_size = base_size, base_family = base_family) +
    theme(
      # Text elements
      text = element_text(
        color = "#2C3E50",
        lineheight = 1.2
      ),
      
      # Plot titles and labels
      plot.title = element_text(
        size = base_size * 1.4,
        face = "bold",
        color = "#1A252F",
        hjust = 0.5
      ),
      
      plot.subtitle = element_text(
        size = base_size * 0.95,
        color = "#5D6D7E",
        hjust = 0.5
      ),
      
      plot.caption = element_text(
        size = base_size * 0.75,
        color = "#7F8C8D",
        hjust = 1
      ),
      
      # Axis elements
      axis.title = element_text(
        size = base_size * 0.95,
        face = "bold",
        color = "#34495E"
      ),
      
      axis.text = element_text(
        size = base_size * 0.85,
        color = "#566573"
      ),
      
      axis.line = element_line(
        color = "#BDC3C7",
        linewidth = 0.4
      ),
      
      axis.ticks = element_line(
        color = "#BDC3C7",
        linewidth = 0.3
      ),
      
      axis.ticks.length = unit(4, "pt"),
      
      # Panel elements
      panel.background = element_rect(
        fill = "#FFFFFF",
        color = NA
      ),
      
      panel.grid.major = element_line(
        color = "#E8EAED",
        linewidth = 0.4
      ),
      
      panel.grid.minor = element_blank(),
      
      panel.border = element_blank(),
      
      # Plot background
      plot.background = element_rect(
        fill = "#FFFFFF",
        color = NA
      ),
      
      # Legend
      legend.position = "top",
      
      legend.background = element_rect(
        fill = "transparent",
        color = NA
      ),
      
      legend.key = element_rect(
        fill = "transparent",
        color = NA
      ),
      
      legend.title = element_text(
        size = base_size * 0.9,
        face = "bold",
        color = "#34495E"
      ),
      
      legend.text = element_text(
        size = base_size * 0.85,
        color = "#566573"
      ),
      
      # Facet labels
      strip.background = element_rect(
        fill = "#F8F9FA",
        color = "#E8EAED",
        linewidth = 0.5
      ),
      
      strip.text = element_text(
        size = base_size * 0.9,
        face = "bold",
        color = "#34495E"
      ),
      
      # Title position
      plot.title.position = "plot",
      plot.caption.position = "plot"
    )
}

# Professional color palettes
nfl_colors <- list(
  primary = c("#2C3E50", "#3498DB", "#E74C3C", "#2ECC71", "#F39C12", "#9B59B6"),
  sequential_blue = c("#EBF5FB", "#AED6F1", "#5DADE2", "#2E86C1", "#1B4F72"),
  sequential_red = c("#FADBD8", "#F1948A", "#E74C3C", "#C0392B", "#922B21"),
  diverging = c("#E74C3C", "#EC7063", "#F5B7B1", "#E8EAED", "#AED6F1", "#5DADE2", "#2E86C1"),
  categorical = c("#3498DB", "#E74C3C", "#2ECC71", "#F39C12", "#9B59B6", 
                  "#1ABC9C", "#E67E22", "#34495E", "#16A085", "#D35400")
)

# Scale functions for consistent colors
scale_color_nfl <- function(palette = "primary", ...) {
  scale_color_manual(values = nfl_colors[[palette]], ...)
}

```

